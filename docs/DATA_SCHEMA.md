# Georgia Legislation Data Schema

This document describes the JSON schema for bill data used throughout the project.

## Bill Object Schema

Each bill object represents a single piece of legislation with the following structure:

```json
{
  "doc_number": "HB 1",
  "caption": "Omnibus Education Reform Bill",
  "sponsors": "Rep. John Smith; Rep. Jane Doe",
  "committees": "Education Committee; Ways and Means Committee",
  "first_reader_summary": "This bill establishes comprehensive education standards...",
  "status_history": [
    {
      "date": "2024-01-15",
      "status": "Introduced"
    },
    {
      "date": "2024-01-20",
      "status": "Assigned to Committee"
    }
  ],
  "detail_url": "https://www.legis.ga.gov/legislation/69281"
}
```

## Field Specifications

| Field                  | Type   | Required | Description                                                                              |
| ---------------------- | ------ | -------- | ---------------------------------------------------------------------------------------- |
| `doc_number`           | string | ✓        | Bill identifier (e.g., "HB 1", "SB 50"). Format: `[HB\|SB] \d+`                          |
| `caption`              | string | ✓        | Official bill title/caption. 1-1000 characters.                                          |
| `sponsors`             | string | ✓        | Comma/semicolon-separated list of sponsor names.                                         |
| `committees`           | string | ✓        | Semicolon-separated list of assigned committees.                                         |
| `detail_url`           | string | ✓        | Full URL to bill details on Georgia General Assembly website. Must be valid HTTP(S) URL. |
| `first_reader_summary` | string | ✗        | Full bill description. May be empty string if not available.                             |
| `status_history`       | array  | ✗        | Array of status objects tracking bill progression. May be empty array.                   |

## Status History Object

```json
{
  "date": "2024-01-15",
  "status": "Introduced"
}
```

| Field    | Type   | Required | Description                                                       |
| -------- | ------ | -------- | ----------------------------------------------------------------- |
| `date`   | string | ✓        | Date in `YYYY-MM-DD` format                                       |
| `status` | string | ✓        | Status text (e.g., "Introduced", "Passed Committee", "Voted Out") |

## Validation Rules

The following validation is enforced:

- **Required fields**: `doc_number`, `caption`, `sponsors`, `committees`, `detail_url`
- **Field types**: All required fields must be strings
- **Field values**: No required fields may be empty or whitespace-only
- **Status history**: If present, must be an array of objects with `date` and `status`
- **Date format**: Status history dates should follow `YYYY-MM-DD` ISO 8601 format

## Example Valid Bill

```json
{
  "doc_number": "HB 42",
  "caption": "Healthcare Access Expansion Act",
  "sponsors": "Rep. Michael Chen; Rep. Patricia Lopez",
  "committees": "Health and Human Services; Appropriations",
  "first_reader_summary": "Expands healthcare access to underserved communities through Medicaid expansion and subsidized insurance programs.",
  "status_history": [
    {
      "date": "2024-01-10",
      "status": "Introduced"
    },
    {
      "date": "2024-02-05",
      "status": "Referred to Health Committee"
    },
    {
      "date": "2024-02-20",
      "status": "Committee Hearing Scheduled"
    }
  ],
  "detail_url": "https://www.legis.ga.gov/legislation/69300"
}
```

## Example Minimal Bill (Valid)

```json
{
  "doc_number": "SB 10",
  "caption": "Tax Credits for Small Businesses",
  "sponsors": "Sen. Robert Wilson",
  "committees": "Ways and Means",
  "status_history": [],
  "detail_url": "https://www.legis.ga.gov/legislation/69250"
}
```

## Data Generation

This schema is generated by `backend/scraper.py`:

1. **Data Source**: Georgia General Assembly website (legis.ga.gov)
2. **Extraction**: Playwright + BeautifulSoup parse HTML/JavaScript
3. **Validation**: All bills validated against this schema before export
4. **Output Format**: Valid JSON array of bill objects

## Frontend Expectations

The frontend (`frontend/script.js`) expects:

- Root level: JSON array `[ {...}, {...}, ... ]`
- Each item: Valid bill object
- No null/undefined values in required fields
- Status history: Chronological order (oldest to newest) for "latest status" feature

## Schema Versioning

Current schema version: **1.0**

### Changes Planned

- [ ] Add legislative session information
- [ ] Add vote data
- [ ] Add amendment tracking
- [ ] Add fiscal impact summaries

## Updating This Schema

If changes are made to bill data structure:

1. Update this document
2. Update validation in `backend/scraper.py`
3. Update frontend to handle new fields
4. Update test data examples
5. Document backwards compatibility considerations

## Troubleshooting

**Issue**: "Expected an array of bills"

- **Cause**: JSON root is not an array
- **Solution**: Ensure JSON starts with `[` and ends with `]`

**Issue**: "Missing required field"

- **Cause**: Bill object missing required field
- **Solution**: Check all required fields are present and non-empty

**Issue**: Frontend displays partial data

- **Cause**: Optional field missing or malformed
- **Solution**: Ensure optional fields are correct type (array, string)
